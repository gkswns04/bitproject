
<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Insert title here</title>
<link rel="stylesheet" type="text/css" href="../css/reset.css">
<link rel="stylesheet" type="text/css" href="../css/common3.css">
<link rel="stylesheet" type="text/css" href="../css/list.css">
<link rel="stylesheet" href="../bower_components/bootstrap/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap.min.css">
<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/css/bootstrap-theme.min.css">
<script src="../bower_components/jquery/dist/jquery.js"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js"></script>
<script src="../bower_components/bootstrap/dist/js/bootstrap.min.js"></script>
<style>

	#d1 {
	   position: relative;
	   min-width: 960px;
	   width: 100%;
	   height: 246px;
	   padding-bottom: 13%;
	   overflow: hidden;
	}
	#logodiv {
	   position: absolute;
	   top: 80px;
	   width: 400px;
	   height: 100px;
	   z-index: 2;
	   right: 50%;
	   margin: 0 -200px 0 0;
	}

  .d2 {
    min-width: 0; height:150px; right: 100px;
    position: relative;
  }

  .d3 {
    min-width: 0; height:150px; width:400px; left: 50%;
    position: relative;
    margin: -178px 0 0 -209px;
    border: 1px solid gray;
  }
  
  .d4 {
    min-width: 0; height: 150px; right: 100px;
    position: relative;
  }
  
  .d5 {
    min-width: 0; height: 150px; right: 100px;
    position: relative;
  }
  
  .d6 {
    min-width: 0; height: 150px; right: 100px;
    position: relative;
  }
  
  .d7 {
    min-width: 0; height: 150px; right: 100px;
    position: relative;
  }

  
   #imgPreview {
    position: absolute;
    left: 50%;
    top: 50%;
    height: 130px;
    width: 150px; 
    margin: 0 -210px 0 -40;
  }
  
  #imgPreviewdiv {
    position: absolute;
    right: 50%;
    top: 5%;
    width: 150px;
    margin: 0 -112px 0 0;
  }
  
   #search {
    position: absolute;
    left: 50%;
    width: 400px;
    height: 41px;
    top: 5%;
    border: 1px gray solid;
    background-image: url( "../images/addsearch.png" );
    background-position: 99% 2px;
    background-repeat: no-repeat;
    font-size: 16px;
    font-weight: normal;
    text-align: left;
    margin: 0 0 0 -109px;
  }
  
  .image {
    position: absolute;
    top: 5%;
    right: 50%;
    margin: 0 -80px 0 0;
  }
  
  .means {
    position: absolute;
    top: -60%;
    height: 40px;
    left: 50%;
    width: 400px;
    border: 1px solid gray;
     margin: 0 0 0 -109px;
  }
  
  .searchdiv {
    position: absolute;
    top: 40%;
    left: 45%;
  }
  
  .asso {
    position: absolute;
    top: -126%;
    right: 50%;
    width: 400px;
    height: 150px;
    border: 1px solid gray;
    margin: 0 -291px 0 -109px;
  }
  
  .addbtndiv {
    position: absolute;
    left: 50%;
    margin: 0 0 0 210px;
    bottom: 16px;
    height: 100px;
  }
  
   #threediv {
   z-index : 100;
   }
 
   #addbtn {
   		width: 80px;
      cursor: pointer;
      background: #242b33;
      padding: 8px 5px;
      font-family: 'BebasNeueRegular','Arial Narrow',Arial,sans-serif;
      color: #fff;
      font-size: 20px;
      border: 1px solid rgb(28, 108, 122);
      margin-top: -25px;
      text-shadow: 0 1px 1px rgba(0, 0, 0, 0.5);
      -webkit-border-radius: 3px;
      -moz-border-radius: 3px;
      border-radius: 3px;
      -webkit-box-shadow: 0px 1px 6px 4px rgba(0, 0, 0, 0.07) inset,
   0px 0px 0px 3px rgb(254, 254, 254),
   0px 5px 3px 3px rgb(210, 210, 210);
      -moz-box-shadow: 0px 1px 6px 4px rgba(0, 0, 0, 0.07) inset,
   0px 0px 0px 3px rgb(254, 254, 254),
   0px 5px 3px 3px rgb(210, 210, 210);
      box-shadow: 0px 1px 6px 4px rgba(0, 0, 0, 0.07) inset,
   0px 0px 0px 3px rgb(254, 254, 254),
   0px 5px 3px 3px rgb(210, 210, 210);
      -webkit-transition: all 0.2s linear;
      -moz-transition: all 0.2s linear;
      -o-transition: all 0.2s linear;
      transition: all 0.2s linear; 
   }

  .title {
    position: absolute;
    top: 32%;
    left: 50%;
    height: 147px;
    width: 230px;
    margin: 0 0 0 -12px;
   }
   
 .line {
   position: absolute;
   right: 50%;
   margin: 0 -110px 0 0;
   content: ' ';
   display: block;
   width: 101%;
   height: 2px;
   margin-top: 45px;
   background: -moz-linear-gradient(left, rgba(36,43,51,0) 0%, rgba(36,43,51,0.8) 20%, rgba(36,43,51,1) 53%, rgba(36,43,51,0.8) 79%, rgba(36,43,51,0) 100%); 
   background: -webkit-gradient(linear, left top, right top, color-stop(0%,rgba(36,43,51,0)), color-stop(20%,rgba(36,43,51,0.8)), color-stop(53%,rgba(36,43,51,1)), color-stop(79%,rgba(36,43,51,0.8)), color-stop(100%,rgba(36,43,51,0))); 
   background: -webkit-linear-gradient(left, rgba(36,43,51,0) 0%,rgba(36,43,51,0.8) 20%,rgba(36,43,51,1) 53%,rgba(36,43,51,0.8) 79%,rgba(36,43,51,0) 100%); 
   background: -o-linear-gradient(left, rgba(36,43,51,0) 0%,rgba(36,43,51,0.8) 20%,rgba(36,43,51,1) 53%,rgba(36,43,51,0.8) 79%,rgba(36,43,51,0) 100%); 
   background: -ms-linear-gradient(left, rgba(36,43,51,0) 0%,rgba(36,43,51,0.8) 20%,rgba(36,43,51,1) 53%,rgba(36,43,51,0.8) 79%,rgba(36,43,51,0) 100%); 
   background: linear-gradient(left, rgba(36,43,51,0) 0%,rgba(36,43,51,0.8) 20%,rgba(36,43,51,1) 53%,rgba(36,43,51,0.8) 79%,rgba(36,43,51,0) 100%); 
  }

</style>

</head>
<body>
  <div id="d1">
     <span id="threediv">
     <nav>
       <ul>
         <li><a href="#" class="newfile-btn"><i></i><img src="../images/newfile.png" width="70"/><br></br><font size='3'>연상법 등록</font></a></li>
         <li><a href="#" class="study-btn"><i></i><img src="../images/pencil.png" width="70"/><br></br><font size='3'>연상법 학습</font></a></li>
         <li><a href="#" class="profile-btn"><i></i><img src="../images/pro.png" width="70"/><br></br><font size='3'>마이 페이지</font></a></li>
       </ul>
     </nav>
     </span>
     
     <div id="logodiv" align="center"><img src="../images/logo.png" id="logo"/></div>
     
     <video autoplay loop poster="../images/strip.jpg" id="bgvid">
     <source src="../images/search_back.mp4" type="video/mp4">
    </video>
     
     </div>
     

  <div class="d7">
   <div class="title" >
       <h2>연상법 등록하기</h2>
      <div class="line" >
    </div>
   </div>
   </div>
   
   
  <div class="d6">
     <div>
      <!-- <form action="" method="post" enctype="multipart/form-data" name=""> -->
          <div class="form-group">
            <input id="search" type="text" 
                   value="단어 검색"  onfocus="this.value=''" onblur="if(this.value =='') this.value=' 단어 검색';" onKeyPress="if (event.keyCode==13){loadMean();event.returnValue=false}"/></div>
      <!-- </form> -->
     </div> 
  </div>
        
  <div class="d4">
     <div>
       <select id="Means" class="means" >
          
       </select>
     </div>
  </div>
     
  <div class="d2">    
     <div>
        <textarea class="asso"  align="center"  placeholder="연상법"></textarea>
     </div>
  </div>
  
  <div class="d3">
     <div class="image" align="center">       
        <input id="inputFile" type="file"></input>
     </div>
     <div id="imgPreviewdiv" align="center" >
        <img id="imgPreview" src="" alt="이곳에 선택된 이미지가 표시됩니다."> 
     </div>
  </div>
  
  <div class="d5">
      <div class="addbtndiv" >
            <button type="button" class="btn btn-default" id="addbtn" >확인</button>
      </div>
  </div>
  <script>

    $(document).ready(function () {
        function readURL(input) {
            if (input.files && input.files[0]) {
                var reader = new FileReader(); //파일을 읽기 위한 FileReader객체 생성
                reader.onload = function (e) {
                    //파일 읽어들이기를 성공했을때 호출되는 이벤트 핸들러
                    $('#imgPreview').attr('src', e.target.result);
                    //이미지 Tag의 SRC속성에 읽어들인 File내용을 지정
                    //(아래 코드에서 읽어들인 dataURL형식)
                }
                reader.readAsDataURL(input.files[0]);
                //File내용을 읽어 dataURL형식의 문자열로 저장
            }
        } //readURL()--

        //file 양식으로 이미지를 선택(값이 변경) 되었을때 처리하는 코드
        $("#inputFile").change(function () {
            //alert(this.value); //선택한 이미지 경로 표시
            readURL(this);
        });
    });
 
  </script>
 <script>
 function loadMean() {
	 $(document).ready(function () {
	 console.log($("#search").val());   
	 // Ajax 통신으로 서버에 Data를 전송하고 Return 받습니다.
	    $.ajax({
	        // type을 설정합니다.
	        type: 'POST',
	        url: "../ajax/searchList/word.do",
	        // 사용자가 입력하여 id로 넘어온 값을 서버로 보냅니다.
	        data: {
	        	word : $("#search").val()
	        	},
	        	
	        // 성공적으로 값을 서버로 보냈을 경우 처리하는 코드입니다.
	        success: function (data) {
	        	
	        	$.getJSON("http://localhost:3000/parseword?word=" + $("#search").val(), function (result) {
	        	
	             var divMeans1 = document.getElementById("Means");
	             var divMeans3 = "<option selected='selected' id='MeansOption'>뜻</option>";
	             divMeans1.innerHTML = divMeans3;
	             console.log(result)
	        	for (i=1; i < result.length; i++) {
	        		console.log(result[i]);
	                 divMeans3 += "<option>" + result[i].mean.substring(2, result[i].mean.length) + "</option>";                   
	                 divMeans1.innerHTML = divMeans3;
	        	}
	        	  $.getJSON("../ajax/searchList/wordList.do", {
	        			      word: result[0].word			      
	        			    }, function(results) {
	        			      if (results.status == "success") {
	        			    	  console.log(result[0].word + "는 DB에 있다");			    	  
	        			      } else {
	        			    	  console.log(result[0].word + "는 DB에 없다");
	        			    	  wordAdd(result[0].word);
	        			    	  wordMeanAdd(result[0].word);
	        			      }
	        			    }, "json"	  
	        			  );
	        	
	        	});
	        }
	    });
	 });
	} 

</script>     
<script>
function wordAdd(word) {
	 $(document).ready(function () {
		  $.get("../ajax/searchList/wordAdd.do", {
		      word: word
		    }, function(result) {
		      if (result.status == "success") {
		    	 console.log(word);
		      } else {
		        /* window.alert("단어 등록 실패입니다!"); */
		      }
		      
		    }, "json"	  
		  );
	 		});
		}
</script>
<script>
function wordMeanAdd(word) {
		$.getJSON("http://localhost:3000/parseword?word=" + word, function (result) {
		for (i=1; i < result.length; i++) {			
			 $.get("../ajax/searchList/wordMeanAdd.do", {
		      word: word,
		      mean: result[i].mean.substring(2, result[i].mean.length)		      
		    }, function(result) {
		      if (result.status == "success") {		    	  
		    	  /* window.alert("단어뜻 등록 성공입니다!"); */		    	  
		      } else {
		        /* window.alert("단어뜻 등록 실패입니다!"); */
		      }
		    }, "json"	  
		  );}});
		}
</script>      
</body>
</html>